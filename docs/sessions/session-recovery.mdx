---
title: Session Recovery
description: How sessions persist and recover across restarts
---

# Session Recovery

## Automatic persistence

Sessions are saved to disk as JSON files in `$TMPDIR/vibe-sessions/`. Writes are debounced to minimize I/O during streaming. The saved state includes the session configuration, message history, task list, permission state, and CLI process PID.

## What happens on server restart

1. The server reads all persisted session files
2. For each session with a recorded PID, it checks if the CLI process is still running
3. If alive, it gives a grace period for the CLI to reconnect its WebSocket
4. If gone (or no reconnection), the server relaunches the CLI with `--resume` using the session's internal ID

This means you can restart The Companion without losing your work. The agent picks up where it left off.

## Limitations

- If both the server and CLI crash at the same time, the last few messages may not be persisted (due to write debouncing)
- Runtime state in the CLI process is lost on restart, though conversation history is preserved
- Docker sessions: the container persists across server restarts, but the CLI inside it is relaunched
